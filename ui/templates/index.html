<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camera & Gimbal Control</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“¹ Camera & Gimbal Control</h1>
            <div class="status">
                <span id="connection-status">ğŸ”´ ì—°ê²° ëŒ€ê¸°ì¤‘</span>
                <span>API: {{ robot_ip }}:{{ api_port }}</span>
            </div>
        </header>

        <div class="content">
            <!-- WebRTC ìŠ¤íŠ¸ë¦¼ -->
            <div class="video-section">
                <h2>ğŸ“º Live Stream</h2>
                <div class="video-container">
                    <video id="webrtc-video" autoplay muted controls></video>
                </div>
            </div>

            <!-- ì¹´ë©”ë¼ ì œì–´ -->
            <div class="control-section">
                <h2>ğŸ“· Camera Control</h2>
                
                <div class="control-group">
                    <h3>ğŸ” Zoom</h3>
                    <div class="button-group">
                        <button onclick="cameraZoomStep(1)">ì¤Œ ì¸ (Step)</button>
                        <button onclick="cameraZoomStep(-1)">ì¤Œ ì•„ì›ƒ (Step)</button>
                    </div>
                    <div class="button-group">
                        <button onclick="cameraZoomContinuous(1)">ì¤Œ ì¸ (ì—°ì†)</button>
                        <button onclick="cameraZoomContinuous(-1)">ì¤Œ ì•„ì›ƒ (ì—°ì†)</button>
                    </div>
                    <div class="range-group">
                        <label>ì¤Œ ë²”ìœ„ (0-100%):</label>
                        <input type="range" id="zoom-range" min="0" max="100" value="0" 
                               onchange="cameraZoomRange(this.value)">
                        <span id="zoom-value">0%</span>
                    </div>
                </div>

                <div class="control-group">
                    <h3>ğŸ‘ï¸ View Source</h3>
                    <select onchange="changeViewSource(this.value)">
                        <option value="0">EO/IR í†µí•©</option>
                        <option value="1">EO</option>
                        <option value="2">IR</option>
                        <option value="3">IR/EO ì „í™˜</option>
                        <option value="4">ë™ê¸°í™” ë·°</option>
                    </select>
                </div>

                <div class="control-group">
                    <h3>ğŸ¯ Focus</h3>
                    <select onchange="setFocusMode(this.value)">
                        <option value="0">ìˆ˜ë™</option>
                        <option value="1">ì¤Œ íŠ¸ë¦¬ê±°</option>
                        <option value="2">ìë™ ê·¼ê±°ë¦¬</option>
                        <option value="3">ìë™ ì›ê±°ë¦¬</option>
                    </select>
                    <div class="button-group">
                        <button onclick="focusContinuous(-1)">ì•ˆìª½</button>
                        <button onclick="focusContinuous(0)">ì •ì§€</button>
                        <button onclick="focusContinuous(1)">ë¬´í•œëŒ€</button>
                        <button onclick="autoFocus()">ìë™ í¬ì»¤ìŠ¤</button>
                    </div>
                </div>

                <div class="control-group">
                    <h3>ğŸŒˆ IR Palette</h3>
                    <select onchange="setIRPalette(this.value)">
                        <option value="1">Palette 1</option>
                        <option value="2">Palette 2</option>
                        <option value="3">Palette 3</option>
                        <option value="4">Palette 4</option>
                        <option value="5">Palette 5</option>
                        <option value="6">Palette 6</option>
                        <option value="7">Palette 7</option>
                        <option value="8">Palette 8</option>
                        <option value="9">Palette 9</option>
                        <option value="10">Palette 10</option>
                    </select>
                </div>

                <div class="control-group">
                    <h3>âš™ï¸ Settings</h3>
                    <div class="button-group">
                        <select onchange="setOSDMode(this.value)">
                            <option value="0">OSD ë¹„í™œì„±í™”</option>
                            <option value="1">ë””ë²„ê·¸ ëª¨ë“œ</option>
                            <option value="2">ìƒíƒœ ì •ë³´</option>
                        </select>
                        <select onchange="setFlipMode(this.value)">
                            <option value="3">í”Œë¦½ ë”</option>
                            <option value="2">í”Œë¦½ ì¼¬</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- ì§ë²Œ ì œì–´ -->
            <div class="control-section">
                <h2>ğŸ® Gimbal Control</h2>
                
                <div class="control-group">
                    <h3>ğŸ”§ Mode</h3>
                    <select onchange="setGimbalMode(this.value)">
                        <option value="0">OFF</option>
                        <option value="1">LOCK</option>
                        <option value="2">FOLLOW</option>
                        <option value="4">RESET</option>
                    </select>
                </div>

                <div class="control-group">
                    <h3>ğŸ“ Position</h3>
                    <div class="position-control">
                        <div>
                            <label>Yaw:</label>
                            <input type="number" id="yaw" value="0" step="0.1">
                        </div>
                        <div>
                            <label>Pitch:</label>
                            <input type="number" id="pitch" value="0" step="0.1">
                        </div>
                        <div>
                            <label>Roll:</label>
                            <input type="number" id="roll" value="0" step="0.1">
                        </div>
                        <button onclick="moveGimbalPosition()">ìœ„ì¹˜ ì´ë™</button>
                    </div>
                </div>

                <div class="control-group">
                    <h3>âš¡ Move Control</h3>
                    <div class="joystick-area">
                        <div class="movement-buttons">
                            <button class="move-btn" data-yaw="5" data-pitch="0" data-roll="0">â†‘</button>
                            <div class="middle-row">
                                <button class="move-btn" data-yaw="0" data-pitch="-5" data-roll="0">â†</button>
                                <button class="stop-btn" onclick="stopGimbal()">â¹ï¸</button>
                                <button class="move-btn" data-yaw="0" data-pitch="5" data-roll="0">â†’</button>
                            </div>
                            <button class="move-btn" data-yaw="-5" data-pitch="0" data-roll="0">â†“</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        window.WEBRTC_URL = "{{ webrtc_url }}";
        window.API_BASE = "/api";
    </script>
    <script src="{{ url_for('static', filename='main.js') }}"></script>
</body>
</html>